<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Inpainting and Outpainting App</title>
</head>
<body>
    <h1>Image Inpainting and Outpainting App</h1>
    <form id="inpainting-form">
        <label for="image">Upload Image:</label>
        <input type="file" id="image" accept="image/*" required><br><br>

        <label for="mask">Upload Mask:</label>
        <input type="file" id="mask" accept="image/*" required><br><br>

        <label for="width">Output Width:</label>
        <input type="number" id="width" required><br><br>

        <label for="height">Output Height:</label>
        <input type="number" id="height" required><br><br>

        <button type="submit">Submit</button>
    </form>
    <div id="result"></div>

    <script>
        document.getElementById('inpainting-form').addEventListener('submit', async function (event) {
            event.preventDefault();

            const imageFile = document.getElementById('image').files[0];
            const maskFile = document.getElementById('mask').files[0];
            const width = document.getElementById('width').value;
            const height = document.getElementById('height').value;
            const token = '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';

            if (!imageFile || !maskFile) {
                alert('Please upload both an image and a mask.');
                return;
            }

            const imageData = await readFileAsDataURL(imageFile);
            const maskData = await readFileAsDataURL(maskFile);

            const response = await fetch('https://api-inference.huggingface.co/models/stable-diffusion-xl-1.0-inpainting-0.1', {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer $(token)`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    inputs: {
                        image: imageData,
                        mask: maskData,
                        dimensions: {
                            width: parseInt(width),
                            height: parseInt(height)
                        }
                    }
                })
            });

            if (!response.ok) {
                alert('Error inpainting image');
                return;
            }

            const result = await response.json();
            displayResult(result);
        });

        function readFileAsDataURL(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = error => reject(error);
                reader.readAsDataURL(file);
            });
        }

        function displayResult(result) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<h2>Inpainted/Outpainted Image:</h2>';
            const img = document.createElement('img');
            img.src = result.output;
            img.alt = 'Inpainted/Outpainted Image';
            resultDiv.appendChild(img);
        }
    </script>
</body>
</html>
